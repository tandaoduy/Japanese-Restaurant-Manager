@model Project_65133141.Models.MonAn

@{
    ViewBag.Title = "Sửa thông tin món ăn";
    Layout = "~/Areas/Admin_65133141/Views/Shared/_Layout.cshtml";
    var categories = ViewBag.Categories as List<Project_65133141.Models.DanhMuc>;
}

<div class="container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6">
    <!-- Header - Responsive -->
    <div class="mb-4 sm:mb-6">
        <h1 class="text-2xl sm:text-3xl font-bold text-gray-900">Sửa thông tin món ăn</h1>
        <p class="text-gray-600 text-sm sm:text-base mt-1">Cập nhật thông tin món ăn trong thực đơn</p>
    </div>

    <!-- Alert Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        ViewBag.AlertType = "success";
        ViewBag.AlertTitle = "Thành công!";
        ViewBag.IsDismissible = true;
        ViewBag.AutoHide = true;
        @Html.Partial("~/Views/Components/_Alert.cshtml", TempData["SuccessMessage"].ToString())
    }

    @if (TempData["ErrorMessage"] != null)
    {
        ViewBag.AlertType = "error";
        ViewBag.AlertTitle = "Lỗi!";
        ViewBag.IsDismissible = true;
        ViewBag.AutoHide = true;
        @Html.Partial("~/Views/Components/_Alert.cshtml", TempData["ErrorMessage"].ToString())
    }

    <!-- Form Card - Responsive -->
    <div class="bg-white rounded-lg shadow-md overflow-hidden max-w-4xl mx-auto">
        @using (Html.BeginForm("Edit", "Product", new { area = "Admin_65133141" }, FormMethod.Post, new { @class = "p-4 sm:p-6", enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(m => m.MonAnID)
            @Html.HiddenFor(m => m.HinhAnh)
            @Html.HiddenFor(m => m.NgayTao)
            @Html.ValidationSummary(true, "", new { @class = "text-red-600 mb-4 text-sm" })

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
                <!-- Tên món -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.TenMon, "Tên món", new { @class = "block text-sm font-medium text-gray-700" })
                        <span class="text-red-500 text-sm ml-1">*</span>
                    </div>
                    @Html.TextBoxFor(m => m.TenMon, new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500", placeholder = "Nhập tên món ăn" })
                    @Html.ValidationMessageFor(m => m.TenMon, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Danh mục -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.DanhMucID, "Danh mục", new { @class = "block text-sm font-medium text-gray-700" })
                        <span class="text-red-500 text-sm ml-1">*</span>
                    </div>
                    @Html.DropDownListFor(m => m.DanhMucID, 
                        new SelectList(categories, "DanhMucID", "TenDanhMuc", Model.DanhMucID), 
                        "-- Chọn danh mục --",
                        new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500" })
                    @Html.ValidationMessageFor(m => m.DanhMucID, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Giá gốc -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.Gia, "Giá gốc (VNĐ)", new { @class = "block text-sm font-medium text-gray-700" })
                        <span class="text-red-500 text-sm ml-1">*</span>
                    </div>
                    @Html.TextBoxFor(m => m.Gia, new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500", type = "number", min = "0", step = "1000", placeholder = "0" })
                    @Html.ValidationMessageFor(m => m.Gia, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Giá giảm (tùy chọn) -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.GiaGiam, "Giá giảm (VNĐ)", new { @class = "block text-sm font-medium text-gray-700" })
                    </div>
                    @Html.TextBoxFor(m => m.GiaGiam, new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500", type = "number", min = "0", step = "1000", placeholder = "Nhập giá sau giảm (nếu có)" })
                    @Html.ValidationMessageFor(m => m.GiaGiam, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Đơn vị tính -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.DonViTinh, "Đơn vị tính", new { @class = "block text-sm font-medium text-gray-700" })
                        <span class="text-red-500 text-sm ml-1">*</span>
                    </div>
                    @Html.TextBoxFor(m => m.DonViTinh, new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500", placeholder = "Phần, Ly, Bát..." })
                    @Html.ValidationMessageFor(m => m.DonViTinh, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Trạng thái -->
                <div>
                    <div class="flex items-center mb-1">
                        @Html.LabelFor(m => m.TrangThai, "Trạng thái", new { @class = "block text-sm font-medium text-gray-700" })
                        <span class="text-red-500 text-sm ml-1">*</span>
                    </div>
                    @Html.DropDownListFor(m => m.TrangThai,
                        new SelectList(new[] {
                            new { Value = "Đang phục vụ", Text = "Đang phục vụ" },
                            new { Value = "Hoạt động", Text = "Hoạt động" },
                            new { Value = "Tạm ngưng", Text = "Tạm ngưng" },
                            new { Value = "Hết hàng", Text = "Hết hàng" }
                        }, "Value", "Text", Model.TrangThai),
                        new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500" })
                    @Html.ValidationMessageFor(m => m.TrangThai, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>

                <!-- Hình ảnh hiện tại -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Hình ảnh hiện tại</label>
                    @if (!string.IsNullOrEmpty(Model.HinhAnh))
                    {
                        <div class="border border-gray-300 rounded-lg p-2 flex items-center justify-center h-24">
                            <img src="@Url.Content("~/Images/Products/" + Model.HinhAnh)" alt="@Model.TenMon" class="max-h-20 rounded" />
                        </div>
                    }
                    else
                    {
                        <div class="border border-gray-300 rounded-lg p-2 flex items-center justify-center h-24 bg-gray-50">
                            <span class="text-gray-400 text-sm">Chưa có hình ảnh</span>
                        </div>
                    }
                </div>

                <!-- Tải hình ảnh mới -->
                <div>
                    @Html.Label("imageFile", "Cập nhật hình ảnh", new { @class = "block text-sm font-medium text-gray-700 mb-1" })
                    <input type="file" name="imageFile" accept="image/*" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500" />
                    <p class="text-xs text-gray-500 mt-1">Để trống nếu không muốn thay đổi</p>
                </div>

                <!-- Nổi bật -->
                <div class="flex items-center md:col-span-2">
                    <label class="flex items-center cursor-pointer">
                        @Html.CheckBoxFor(m => m.IsNoiBat, new { @class = "w-5 h-5 text-red-600 border-gray-300 rounded focus:ring-red-500" })
                        <span class="ml-2 text-sm font-medium text-gray-700">Đánh dấu là món nổi bật</span>
                    </label>
                </div>

                <!-- Mô tả (Full width) -->
                <div class="md:col-span-2">
                    @Html.LabelFor(m => m.MoTa, "Mô tả món ăn", new { @class = "block text-sm font-medium text-gray-700 mb-1" })
                    @Html.TextAreaFor(m => m.MoTa, 4, 0, new { @class = "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500", placeholder = "Nhập mô tả chi tiết về món ăn..." })
                    @Html.ValidationMessageFor(m => m.MoTa, "", new { @class = "text-red-600 text-sm mt-1" })
                </div>
            </div>

            <!-- Buttons - Responsive: Stack on mobile, row on tablet+ -->
            <div class="mt-6 flex flex-col-reverse sm:flex-row items-stretch sm:items-center justify-end gap-3 sm:space-x-4">
                <a href="@Url.Action("Index", "Product", new { area = "Admin_65133141" })" 
                   class="px-4 sm:px-6 py-2.5 sm:py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors text-center sm:text-left w-full sm:w-auto">
                    Hủy
                </a>
                <button type="submit" 
                        class="px-4 sm:px-6 py-2.5 sm:py-2 bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg w-full sm:w-auto">
                    <span class="flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                        </svg>
                        Cập nhật
                    </span>
                </button>
            </div>
        }
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}

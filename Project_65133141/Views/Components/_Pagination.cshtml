@{
    var baseUrl = ViewBag.BaseUrl as string ?? "";
    var pageParam = ViewBag.PageParam as string ?? "page";
    var currentPage = ViewBag.CurrentPage as int? ?? 1;
    var totalPages = ViewBag.TotalPages as int? ?? 1;
    
    // Helper to get URL separator
    string GetUrlSeparator()
    {
        return baseUrl.Contains("?") ? "&" : "?";
    }
    
    // Calculate pagination values
    int startPage = 1;
    int endPage = 1;
    string urlSep = "";
    
    if (totalPages > 1)
    {
        startPage = Math.Max(1, currentPage - 2);
        endPage = Math.Min(totalPages, currentPage + 2);
        urlSep = GetUrlSeparator();
    }
}

<style>
    .pagination-container {
        margin-top: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    .pagination-nav {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .pagination-btn-circle {
        width: 40px;
        height: 40px;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #e5e7eb;
        background: white;
        border-radius: 50%;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        color: #6b7280;
        text-decoration: none;
    }

    .pagination-btn-circle:hover:not(.active):not(.disabled) {
        border-color: #14b8a6;
        color: #14b8a6;
        transform: translateY(-2px);
    }

    .pagination-btn-circle.active {
        background: #14b8a6;
        border-color: #14b8a6;
        color: white;
    }

    .pagination-btn-circle.disabled {
        opacity: 0.3;
        cursor: not-allowed;
        pointer-events: none;
    }

    .pagination-info-text {
        color: #6b7280;
        font-size: 14px;
        font-weight: 500;
    }
</style>

@if (totalPages > 1)
{
    <div class="pagination-container">
        <nav class="pagination-nav" aria-label="Pagination">
            @* First Page Button *@
            @if (currentPage > 1)
            {
                <a href="@(baseUrl + urlSep + pageParam + "=1")" 
                   class="pagination-btn-circle" 
                   title="Trang đầu">«</a>
            }
            else
            {
                <span class="pagination-btn-circle disabled" title="Trang đầu">«</span>
            }
            
            @* Previous Button *@
            @if (currentPage > 1)
            {
                <a href="@(baseUrl + urlSep + pageParam + "=" + (currentPage - 1))"
                   class="pagination-btn-circle"
                   title="Trang trước">‹</a>
            }
            else
            {
                <span class="pagination-btn-circle disabled" title="Trang trước">‹</span>
            }

            @* Page number buttons *@
            @for (int i = startPage; i <= endPage; i++)
            {
                if (i == currentPage)
                {
                    <span class="pagination-btn-circle active">@i</span>
                }
                else
                {
                    <a href="@(baseUrl + urlSep + pageParam + "=" + i)"
                       class="pagination-btn-circle">@i</a>
                }
            }

            @* Next Button *@
            @if (currentPage < totalPages)
            {
                <a href="@(baseUrl + urlSep + pageParam + "=" + (currentPage + 1))"
                   class="pagination-btn-circle"
                   title="Trang sau">›</a>
            }
            else
            {
                <span class="pagination-btn-circle disabled" title="Trang sau">›</span>
            }
            
            @* Last Page Button *@
            @if (currentPage < totalPages)
            {
                <a href="@(baseUrl + urlSep + pageParam + "=" + totalPages)"
                   class="pagination-btn-circle"
                   title="Trang cuối">»</a>
            }
            else
            {
                <span class="pagination-btn-circle disabled" title="Trang cuối">»</span>
            }
        </nav>
        
        @* Page info *@
        <div class="pagination-info-text">
            Trang @currentPage / @totalPages
        </div>
    </div>
}
